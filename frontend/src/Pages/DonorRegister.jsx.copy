{
  "corrected_new_string_escaping": "{/* eslint-disable prettier/prettier */}\n// Pages/DonorRegister.jsx\n// Donor profile form for authenticated users; submits to /donors/register.\n\nimport React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport api, { getAddressByPostalCode } from \"../lib/api\";\n\nfunction Navbar({ isDark, toggleTheme }) {\n  return (\n    <nav className=\"mx-auto flex w-full max-w-7xl items-center justify-between px-4 py-5 md:px-6\">\n      <Link to=\"\" className=\"flex items-center gap-3\">\n        <div className=\"flex h-10 w-10 items-center justify-center rounded-xl bg-gradient-to-br from-rose-500 to-red-600 text-white shadow-lg ring-1 ring-black/10 dark:ring-white/10\">\n          <span className=\"text-xl\" role=\"img\" aria-label=\"Blood drop\">ðŸ©¸</span>\n        </div>\n        <div className=\"leading-tight\">\n          <p className=\"text-lg font-extrabold tracking-tight bg-gradient-to-r from-rose-600 to-red-600 bg-clip-text text-transparent dark:from-rose-300 dark:to-amber-200\">Blood Donation</p>\n          <p className=\"text-xs text-gray-600 dark:text-gray-300\">Connect. Donate. Save lives.</p>\n        </div>\n      </Link>\n      <button\n        onClick={toggleTheme}\n        className=\"inline-flex items-center gap-2 rounded-full border border-black/10 bg-white/70 px-4 py-2 text-sm font-medium text-gray-900 shadow-sm backdrop-blur-md transition hover:bg-white/90 dark:border-white/10 dark:bg-white/10 dark:text-white dark:hover:bg-white/15\"\n        aria-label=\"Toggle dark mode\"\n      >\n        <span className=\"h-4 w-4\" aria-hidden=\"true\">{isDark ? \"ðŸŒ™\" : \"â˜€ï¸\"}</span>\n        <span>{isDark ? \"Dark\" : \"Light\"} mode</span>\n      </button>\n    </nav>\n  );\n}\n\nimport Layout from \"../components/Layout\";\n\n// Allowed values and regex patterns for client-side validation\nconst BLOOD_GROUPS = [\'A+\",\'A-\",\'B+\",\'B-\",\'AB+\",\'AB-\",\'O+\",\'O-\"];\nconst NAME_REGEX = /^[A-Za-z\s]*$/;                               // letters and spaces only\nconst CITY_DISTRICT_REGEX = /^[A-Za-z\s]{2,50}$/;                 // letters and spaces\nconst ALNUM_SPACE_ADDR_REGEX = /^[A-Za-z0-9\s.,-]{3,200}$/;       // letters/numbers/spaces with , . -\nconst PHONE_IN_REGEX = /^[^6-9]\d{9}$/;                            // Indian 10-digit starting 6-9\nconst PINCODE_REGEX = /^\d{6}$/;\n\nexport default function DonorRegister() {\n  const navigate = useNavigate();\n  const [isDonor, setIsDonor] = React.useState(true);\n  const [isAlreadyDonor, setIsAlreadyDonor] = React.useState(false);\n  const [errors, setErrors] = React.useState([]);\n  const [loading, setLoading] = React.useState(false);\n  const [addressLoading, setAddressLoading] = React.useState(false);\n\n  const [formData, setFormData] = React.useState({\n    firstName: \"\",\n    lastName: \"\",\n    dob: \"\",\n    gender: \"\",\n    bloodGroup: \"\",\n    contactNumber: \"\",\n    emergencyContactNumber: \"\",\n    houseName: \"\",\n    houseAddress: \"\",\n    localBody: \"\",\n    city: \"\",\n    district: \"\",\n    postalCode: \"\",\n    pincode: \"\",\n    workAddress: \"\",\n    weight: \"\",\n    availability: \"available\",\n    lastDonationDate: \"\",\n    contactPreference: \"phone\",\n  });\n\n  useEffect(() => {\n    const fetchUserAndDonorData = async () => {\n      try {\n        // Fetch user data\n        try {\n          const { data: userData } = await api.get('/users/me');\n          if (userData.success) {\n            setFormData(prev => {\n              const fullName = userData.data.name || \"\";\n              const [firstName, ...lastNameParts] = fullName.split(\" \");\n              const lastName = lastNameParts.join(\" \");\n              return {\n                ...prev,\n                firstName,\n                lastName,\n                contactNumber: userData.data.phone || \"\",\n              };\n            });\n          } else {\n            throw new Error('Failed to fetch user profile data');\n          }\n        } catch (userError) {\n          console.error('Error fetching user data:', userError);\n          if (userError.response?.status === 401) {\n            setErrors(['Authentication failed. Please log in again.']);\n          } else if (userError.response?.status === 403) {\n            setErrors(['Access denied. You do not have permission to access this resource.']);\n          } else if (userError.response?.status >= 500) {\n            setErrors(['Server error occurred while fetching user data. Please try again later.']);\n          } else {\n            setErrors(['Failed to load user profile. Please refresh the page and try again.']);\n          }\n          return;\n        }\n\n        // Fetch existing donor data if available\n        try {\n          const { data: donorData } = await api.get('/donors/me');\n          if (donorData.success) {\n            setIsAlreadyDonor(true);\n            // Populate form with existing donor data\n            const donor = donorData.data;\n            setFormData(prev => {\n              const fullName = donor.name || \"\";\n              const [firstName, ...lastNameParts] = fullName.split(\" \");\n              const lastName = lastNameParts.join(\" \");\n              return {\n                ...prev,\n                firstName,\n                lastName,\n                dob: donor.dob ? donor.dob.split('T')[0] : prev.dob,\n                gender: donor.gender || prev.gender,\n                bloodGroup: donor.bloodGroup || prev.bloodGroup,\n                contactNumber: donor.contactNumber || prev.contactNumber,\n                emergencyContactNumber: donor.emergencyContactNumber || prev.emergencyContactNumber,\n                houseName: donor.houseAddress?.houseName || prev.houseName,\n                houseAddress: donor.houseAddress?.houseAddress || prev.houseAddress,\n                localBody: donor.houseAddress?.localBody || prev.localBody,\n                city: donor.houseAddress?.city || prev.city,\n                district: donor.houseAddress?.district || prev.district,\n                postalCode: donor.houseAddress?.postalCode || prev.postalCode,\n                pincode: donor.houseAddress?.pincode || prev.pincode,\n                workAddress: donor.workAddress || prev.workAddress,\n                weight: donor.weight || prev.weight,\n                availability: donor.availability ? \"available\" : \"unavailable\",\n                lastDonationDate: donor.lastDonatedDate ? donor.lastDonatedDate.split('T')[0] : prev.lastDonationDate,\n                contactPreference: donor.contactPreference || prev.contactPreference,\n              };\n            });\n          } else {\n            throw new Error('Failed to fetch donor profile data');\n          }\n        } catch (donorError) {\n          // User is not a donor, which is fine - don't show error for this\n          if (donorError.response?.status !== 404) {\n            console.error('Error fetching donor data:', donorError);\n            if (donorError.response?.status === 401) {\n              setErrors(['Authentication failed while fetching donor data. Please log in again.']);\n            } else if (donorError.response?.status === 403) {\n              setErrors(['Access denied. You do not have permission to access this resource.']);\n            } else if (donorError.response?.status >= 500) {\n              setErrors(['Server error occurred while fetching donor data. Please try again later.']);\n            } else {\n              setErrors(['Failed to load donor profile. Please refresh the page and try again.']);\n            }\n          }\n          setIsAlreadyDonor(false);\n        }\n      } catch (error) {\n        console.error('Unexpected error in fetchUserAndDonorData:', error);\n        setErrors(['An unexpected error occurred while loading your data. Please refresh the page and try again.']);\n      }\n    };\n    fetchUserAndDonorData();\n  }, []);\n\n  const validateForm = () => {\n    const errors = [];\n\n    // Blood group whitelist\n    if (!BLOOD_GROUPS.includes(formData.bloodGroup)) {\n      errors.push(\"Invalid blood group. Allowed: \" + BLOOD_GROUPS.join(\", \"));\n    }\n\n    // First and last name: only letters/spaces\n    if (!NAME_REGEX.test((formData.firstName || \"\").trim())) {\n      errors.push(\"First name must contain only letters and spaces\");\n    }\n    if (!NAME_REGEX.test((formData.lastName || \"\").trim())) {\n      errors.push(\"Last name must contain only letters and spaces\");\n    }\n\n    // Phone numbers: Indian range (10 digits starting with 6-9)\n    if (!PHONE_IN_REGEX.test(formData.contactNumber)) {\n      errors.push(\"Contact number must be a valid Indian number (10 digits, starts with 6-9)\");\n    }\n    if (!PHONE_IN_REGEX.test(formData.emergencyContactNumber)) {\n      errors.push(\"Emergency contact must be a valid Indian number (10 digits, starts with 6-9)\");\n    }\n    if (formData.contactNumber === formData.emergencyContactNumber) {\n      errors.push(\"Emergency contact cannot be the same as contact number\");\n    }\n\n    // Pincode validation (6 digits)\n    if (!PINCODE_REGEX.test(formData.pincode)) {\n      errors.push(\"Pincode must be exactly 6 digits\");\n    }\n\n    // City/District: names only\n    if (!CITY_DISTRICT_REGEX.test((formData.city || \"\").trim())) {\n      errors.push(\"City must contain only letters and spaces\");\n    }\n    if (!CITY_DISTRICT_REGEX.test((formData.district || \"\").trim())) {\n      errors.push(\"District must contain only letters and spaces\");\n    }\n\n    // House and work address fields: alnum + , . - allowed\n    if (!ALNUM_SPACE_ADDR_REGEX.test((formData.houseName || \"\").trim())) {\n      errors.push(\"House name must contain only letters, numbers, spaces or , . -\");\n    }\n    if (!ALNUM_SPACE_ADDR_REGEX.test((formData.houseAddress || \"\").trim())) {\n      errors.push(\"House address must contain only letters, numbers, spaces or , . -\");\n    }\n    if (!ALNUM_SPACE_ADDR_REGEX.test((formData.localBody || \"\").trim())) {\n      errors.push(\"Local body must contain only letters, numbers, spaces or , . -\");\n    }\n    if (!ALNUM_SPACE_ADDR_REGEX.test((formData.workAddress || \"\").trim())) {\n      errors.push(\"Work address must contain only letters, numbers, spaces or , . -\");\n    }\n\n    // Required fields\n    const requiredFields = ['firstName', 'lastName', 'dob', 'gender', 'bloodGroup', 'contactNumber', 'emergencyContactNumber', 'houseName', 'houseAddress', 'localBody', 'city', 'district', 'pincode', 'workAddress', 'weight'];\n    requiredFields.forEach(field => {\n      if (!formData[field] || formData[field].toString().trim() === '') {\n        errors.push(\
          `${field.charAt(0).toUpperCase() + field.slice(1)} is required`\n        );\n      }\n    });\n\n    // Validate no fields with only spaces\n    Object.entries(formData).forEach(([key, value]) => {\n      if (typeof value === 'string' && value.trim() === '') {\n        errors.push(\
          `${key.charAt(0).toUpperCase() + key.slice(1)} cannot be empty or only spaces`\n        );\n      }\n    });\n\n    // Validate dob: no future date and age >= 18\n    if (formData.dob) {\n      const dobDate = new Date(formData.dob);\n      const today = new Date();\n      if (dobDate > today) {\n        errors.push(\"Date of birth cannot be in the future\");\n      }\n      let age = today.getFullYear() - dobDate.getFullYear();\n      const m = today.getMonth() - dobDate.getMonth();\n      if (m < 0 || (m === 0 && today.getDate() < dobDate.getDate())) {\n        age--;\n      }\n      if (age < 18) {\n        errors.push(\"Donor must be at least 18 years old\");\n      }\n    }\n\n    // Validate lastDonationDate: any date after donor reached 18 years of age\n    if (formData.lastDonationDate) {\n      const lastDate = new Date(formData.lastDonationDate);\n      const today = new Date();\n\n      // Check if date is in the future (not allowed)\n      if (lastDate > today) {\n        errors.push(\"Last donation date cannot be in the future\");\n      }\n\n      // If DOB is provided, check that donation date is not before 18th birthday\n      if (formData.dob) {\n        const dobDate = new Date(formData.dob);\n        const eighteenthBirthday = new Date(dobDate);\n        eighteenthBirthday.setFullYear(dobDate.getFullYear() + 18);\n\n        if (lastDate < eighteenthBirthday) {\n          errors.push(\"Last donation date cannot be before your 18th birthday\");\n        }\n      }\n    }\n\n    // Validate weight > 55kg and < 140kg\n    if (formData.weight) {\n      const weightNum = Number(formData.weight);\n      if (isNaN(weightNum) || weightNum <= 55 || weightNum >= 140) {\n        errors.push(\"Weight must be between 56kg and 139kg\");\n      }\n    }\n\n    return errors;\n  };\n\n  const formatDate = (dateStr) => {\n    if (!dateStr) return dateStr;\n    if (dateStr.match(/^\\d{4}-\\d{2}-\\d{2}$/)) return dateStr;\n    if (dateStr.match(/^\\d{2}-\\d{2}-\\d{4}$/)) {\n      const [dd, mm, yyyy] = dateStr.split('-');\n      return `${yyyy}-${mm}-${dd}`.replace(/\n/g, ''); // Remove potential newlines\n    }\n    return dateStr.replace(/\n/g, ''); // Remove potential newlines\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setErrors([]);\n    setLoading(true);\n\n    const validationErrors = validateForm();\n    if (validationErrors.length > 0) {\n      setErrors(validationErrors);\n      setLoading(false);\n      return;\n    }\n\n    let attempt = 0;\n    const maxAttempts = 3;\n    while (attempt < maxAttempts) {\n      try {\n        try {\n          // Add token from localStorage to Authorization header\n          const token = localStorage.getItem('accessToken');\n          const config = {\n            headers: {\n              Authorization: token ? `Bearer ${token}` : '',\n            },\n          };\n          const payload = {\n            name: getFullName(),\n            dob: formatDate(formData.dob),\n            gender: formData.gender,\n            bloodGroup: formData.bloodGroup,\n            contactNumber: formData.contactNumber,\n            emergencyContactNumber: formData.emergencyContactNumber,\n            houseAddress: {\n              houseName: formData.houseName,\n              houseAddress: formData.houseAddress,\n              localBody: formData.localBody,\n              city: formData.city,\n              district: formData.district,\n              postalCode: formData.postalCode,\n              pincode: formData.pincode,\n            },\n            workAddress: formData.workAddress,\n            weight: parseFloat(formData.weight),\n            availability: formData.availability === \"available\",\n            contactPreference: formData.contactPreference,\n            ...(formData.lastDonationDate && { lastDonatedDate: formatDate(formData.lastDonationDate) }),\n          };\n\n          let res;\n          if (isAlreadyDonor) {\n            // Update existing donor profile\n            res = await api.put(\"/donors/update\", payload, config);\n          } else {\n            // Register new donor profile\n            res = await api.post(\"/donors/register\", payload, config);\n          }\n\n          const successMsg = isAlreadyDonor ? \"âœ… Donor details updated\" : \"âœ… Donor details saved\";\n          const errorMsg = isAlreadyDonor ? \"Failed to update donor details\" : \"Failed to save donor details\";\n\n          if (res?.data?.success) {\n            alert(successMsg);\n            // Redirect to donor CRUD page after successful registration/update\n            navigate('/donor-crud');\n            break;\n          } else {\n            setErrors([res?.data?.message || errorMsg]);\n            break;\n          }\n        } catch (err) {\n          attempt++;\n          if (attempt >= maxAttempts) {\n            let errorMessages = [];\n\n            if (err?.response?.status === 400) {\n              // Validation errors\n              if (err.response.data.errors && Array.isArray(err.response.data.errors)) {\n                errorMessages = err.response.data.errors.map(e => e.message || e);\n              } else {\n                errorMessages = [err.response.data.message || \"Invalid data provided. Please check your input.\"];\n              }\n            } else if (err?.response?.status === 401) {\n              errorMessages = [\"Authentication failed. Please log in again.\"];\n            } else if (err?.response?.status === 403) {\n              errorMessages = [\"Access denied. You do not have permission to perform this action.\"];\n            } else if (err?.response?.status === 409) {\n              errorMessages = [\"A donor profile already exists for this user.\"];\n            } else if (err?.response?.status === 422) {\n              errorMessages = [\"Data validation failed. Please check all required fields.\"];\n            } else if (err?.response?.status >= 500) {\n              errorMessages = [\"Server error occurred. Please try again later.\"];\n            } else if (!err?.response) {\n              errorMessages = [\"Network error. Please check your internet connection and try again.\"];\n            } else {\n              const errorMsg = isAlreadyDonor ? \"Failed to update donor details\" : \"Failed to save donor details\";\n              errorMessages = [err?.response?.data?.message || errorMsg];\n            }\n\n            setErrors(errorMessages);\n            break;\n          }\n        }\n      } catch (outerErr) {\n        setErrors([\"Unexpected error occurred: \" + outerErr.message]);\n        break;\n      }\n    }\n    setLoading(false);\n  };\n\n  const handleChange = (e) => {\n    const { name, value: inputValue } = e.target;\n    let processedValue = inputValue;\n\n    if (name === 'firstName' || name === 'lastName') {\n      // Only allow letters and spaces\n      processedValue = inputValue.replace(/[^a-zA-Z\s]/g, '');\n      // Convert to sentence case: first letter capital, rest lower\n      processedValue = processedValue.charAt(0).toUpperCase() + processedValue.slice(1).toLowerCase();\n    }\n\n    if (name === 'district' || name === 'city') {\n      // Capitalize first letter for district and city\n      processedValue = processedValue.charAt(0).toUpperCase() + processedValue.slice(1).toLowerCase();\n    }\n\n    setFormData(prevFormData => ({\n      ...prevFormData,\n      [name]: processedValue\n    }));\n  };\n\n  const handlePincodeBlur = async () => {\n    const pincode = formData.pincode;\n    if (pincode && pincode.length === 6 && /^\\d{6}$/.test(pincode)) {\n      setAddressLoading(true);\n      try {\n        const response = await getAddressByPostalCode(pincode);\n        if (response.success) {\n          const addressData = response.data;\n          setFormData(prev => ({\n            ...prev,\n            city: addressData.city || prev.city,\n            district: addressData.district || prev.district,\n          }));\n        }\n      } catch (error) {\n        console.error('Error fetching address:', error);\n        // Optionally show a user-friendly message, but don't interrupt the form\n      } finally {\n        setAddressLoading(false);\n      }\n    }\n  };\n\n  // Combine firstName and lastName into name for backend\n  const getFullName = () => {\n    return `${formData.firstName.trim()} ${formData.lastName.trim()}`.trim();\n  };\n\n  const handleDelete = async () => {\n    if (!window.confirm(\"Are you sure you want to delete your donor profile? This action cannot be undone.\")) {\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('accessToken');\n      const config = {\n        headers: {\n          Authorization: token ? `Bearer ${token}` : '',\n        },\n      };\n\n      const res = await api.delete(\"/donors/delete\", config);\n\n      if (res?.data?.success) {\n        alert(\"âœ… Donor profile deleted successfully\");\n        setIsAlreadyDonor(false);\n        // Reset form data\n        setFormData({\n          firstName: \"\",\n          lastName: \"\",\n          dob: \"\",\n          gender: \"\",\n          bloodGroup: \"\",\n          contactNumber: \"\",\n          emergencyContactNumber: \"\",\n          houseName: \"\",\n          houseAddress: \"\",\n          localBody: \"\",\n          city: \"\",\n          district: \"\",\n          postalCode: \"\",\n          pincode: \"\",\n          workAddress: \"\",\n          weight: \"\",\n          availability: \"available\",\n          lastDonationDate: \"\",\n          contactPreference: \"phone\",\n        });\n        navigate('/dashboard');\n      } else {\n        alert(\"âŒ \" + (res?.data?.message || \"Failed to delete donor profile\"));\n      }\n    } catch (err) {\n      let msg = err?.response?.data?.message || \"Failed to delete donor profile\";\n      if (err?.response?.data?.errors && Array.isArray(err.response.data.errors)) {\n        msg = err.response.data.errors.map(e => e.message).join(\"\\n\");\n      }\n      alert(\"âŒ \" + msg);\n    }\n  };\n\n  return (\n    <Layout>\n      <div className=\"flex justify-center mb-6\">\n        <div className=\"flex bg-white/20 rounded-full p-1 backdrop-blur-md\">\n          <button\n            onClick={() => setIsDonor(true)}\n            className={`px-6 py-2 rounded-full font-semibold transition ${\n              isDonor ? \"bg-pink-600 text-white\" : \"text-gray-700 dark:text-gray-300\"\n            }`}\n          >\n            {isAlreadyDonor ? \"Edit Donor Details\" : \"Become a Donor\"}\n          </button>\n          <button\n            onClick={() => setIsDonor(false)}\n            className={`px-6 py-2 rounded-full font-semibold transition ${\n              !isDonor ? \"bg-pink-600 text-white\" : \"text-gray-700 dark:text-gray-300\"\n            }`}\n          >\n            User Registration\n          </button>\n        </div>\n      </div>\n\n      <form\n        onSubmit={handleSubmit}\n        className=\"mx-auto w-full max-w-3xl rounded-2xl border border-white/30 bg-white/30 p-6 shadow-2xl backdrop-blur-2xl transition dark:border-white/10 dark:bg-white/5 md:p-10 overflow-y-auto max-h-[90vh] scrollbar-thin scrollbar-thumb-pink-400 scrollbar-track-transparent\"\n      >\n        <div className=\"mb-8 text-center\">\n          <h2 className=\"mb-2 text-3xl font-extrabold tracking-tight text-gray-900 dark:text-white md:text-4xl\">\n            {isDonor ? \"ðŸ©¸ Become a Blood Donor\" : \"ðŸ¥ User Registration\"}\n          </h2>\n          <p className=\"text-sm text-gray-700 dark:text-gray-300 md:text-base\">\n            {isDonor ? \"Join our heroes saving lives every day\" : \"Register to request blood when needed\"}\n          </p>\n        </div>\n\n        {/* Error Display */}\n        {errors.length > 0 && (\n          <div className=\"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl dark:bg-red-900/20 dark:border-red-800\">\n            <div className=\"flex items-center mb-2\">\n              <span className=\"text-red-600 dark:text-red-400 text-lg mr-2\">âš ï¸</span>\n              <h3 className=\"text-red-800 dark:text-red-200 font-semibold\">\n                Please fix the following errors:\n              </h3>\n            </div>\n            <ul className=\"list-disc list-inside space-y-1 text-red-700 dark:text-red-300 text-sm\">\n              {errors.map((error, index) => (\n                <li key={index}>{error}</li>\n              ))}\n            </ul>\n          </div>\n        )}\n\n        <div className=\"mb-6 grid grid-cols-1 gap-6 md:grid-cols-2\">\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">First Name</label>\n            <input\n              type=\"text\"\n              name=\"firstName\"\n              placeholder=\"First Name\"\n              title=\"Only letters and spaces allowed\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.firstName}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Last Name</label>\n            <input\n              type=\"text\"\n              name=\"lastName\"\n              placeholder=\"Last Name\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.lastName}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Date of Birth</label>\n            <input\n              type=\"date\"\n              name=\"dob\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.dob}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Gender</label>\n            <select\n              name=\"gender\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white\"\n              value={formData.gender}\n              onChange={handleChange}\n              required\n            >\n              <option value=\"\" className=\"text-gray-800\">Select Gender</option>\n              <option value=\"Male\" className=\"text-gray-800\">Male</option>\n              <option value=\"Female\" className=\"text-gray-800\">Female</option>\n              <option value=\"Other\" className=\"text-gray-800\">Other</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Blood group</label>\n            <select\n              name=\"bloodGroup\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white\"\n              value={formData.bloodGroup}\n              onChange={handleChange}\n              required\n            >\n              <option value=\"\" className=\"text-gray-800\">Select Blood Group</option>\n              <option value=\"A+\" className=\"text-gray-800\">A+</option>\n              <option value=\"A-\" className=\"text-gray-800\">A-</option>\n              <option value=\"B+\" className=\"text-gray-800\">B+</option>\n              <option value=\"B-\" className=\"text-gray-800\">B-</option>\n              <option value=\"AB+\" className=\"text-gray-800\">AB+</option>\n              <option value=\"AB-\" className=\"text-gray-800\">AB-</option>\n              <option value=\"O+\" className=\"text-gray-800\">O+</option>\n              <option value=\"O-\" className=\"text-gray-800\">O-</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Contact Number</label>\n            <input\n              type=\"tel\"\n              name=\"contactNumber\"\n              placeholder=\"Contact Number\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.contactNumber}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Emergency Contact Number</label>\n            <input\n              type=\"tel\"\n              name=\"emergencyContactNumber\"\n              placeholder=\"Emergency Contact Number\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.emergencyContactNumber}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">House Name</label>\n            <input\n              type=\"text\"\n              name=\"houseName\"\n              placeholder=\"House Name\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.houseName}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">House Address</label>\n            <input\n              type=\"text\"\n              name=\"houseAddress\"\n              placeholder=\"House Address\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.houseAddress}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Local Body</label>\n            <input\n              type=\"text\"\n              name=\"localBody\"\n              placeholder=\"Local Body\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.localBody}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">City</label>\n            <input\n              type=\"text\"\n              name=\"city\"\n              placeholder=\"City\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.city}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">District</label>\n            <input\n              type=\"text\"\n              name=\"district\"\n              placeholder=\"District\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.district}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Pincode</label>\n            <input\n              type=\"text\"\n              name=\"pincode\"\n              placeholder=\"Pincode\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.pincode}\n              onChange={handleChange}\n              onBlur={handlePincodeBlur}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Work Address</label>\n            <input\n              type=\"text\"\n              name=\"workAddress\"\n              placeholder=\"Work Address\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.workAddress}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Weight (in kg)</label>\n            <input\n              type=\"number\"\n              name=\"weight\"\n              placeholder=\"Weight\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.weight}\n              onChange={handleChange}\n              required\n            />\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Availability</label>\n            <select\n              name=\"availability\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white\"\n              value={formData.availability}\n              onChange={handleChange}\n              required\n            >\n              <option value=\"available\" className=\"text-gray-800\">Available</option>\n              <option value=\"unavailable\" className=\"text-gray-800\">Unavailable</option>\n            </select>\n          </div>\n\n          <div>\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Last Donation Date</label>\n            <input\n              type=\"date\"\n              name=\"lastDonationDate\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 placeholder-gray-600 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white dark:placeholder-gray-300\"\n              value={formData.lastDonationDate}\n              onChange={handleChange}\n            />\n          </div>\n\n          <div className=\"md:col-span-2\">\n            <label className=\"mb-2 block text-sm font-medium text-gray-800 dark:text-gray-200\">Contact Preference</label>\n            <select\n              name=\"contactPreference\"\n              className=\"w-full rounded-2xl border border-white/30 bg-white/20 px-4 py-3 text-gray-900 shadow-inner outline-none backdrop-blur-md focus:ring-2 focus:ring-rose-400/60 dark:border-white/10 dark:bg-white/10 dark:text-white\"\n              value={formData.contactPreference}\n              onChange={handleChange}\n              required\n            >\n              <option value=\"phone\" className=\"text-gray-800\">Phone</option>\n              <option value=\"email\" className=\"text-gray-800\">Email</option>\n            </select>\n          </div>\n        </div>\n\n        <div className=\"mt-8 flex justify-between\">\n          <button\n            type=\"submit\"\n            disabled={loading}\n            className=\"w-full rounded-2xl bg-gradient-to-br from-rose-500 to-red-600 px-8 py-4 font-bold text-white shadow-lg transition hover:scale-105 hover:shadow-xl disabled:opacity-50\"\n          >\n            {loading ? \"Submitting...\" : (isAlreadyDonor ? \"Update Profile\" : \"Register as Donor\")}\n          </button>\n          {isAlreadyDonor && (\n            <button\n              type=\"button\"\n              onClick={handleDelete}\n              className=\"ml-4 rounded-2xl bg-red-800 px-8 py-4 font-bold text-white shadow-lg transition hover:scale-105 hover:shadow-xl\"\n            >\n              Delete Profile\n            </button>\n          )}\n        </div>\n      </form>\n    </Layout>\n  );\n}\n"
