
> backend@1.0.0 test
> jest --runInBand

[baseline-browser-mapping] The data in this module is over two months old.  To ensure accurate Baseline data, please update: `npm i baseline-browser-mapping@latest -D`
  console.log
    ðŸŒ Production CORS origins added: [ 'http://localhost:5173' ]

      at Object.log (app.js:40:11)

  console.warn
    âš ï¸  Firebase service account not found. Firebase features will be disabled.

    [0m [90m 54 |[39m [90m// If still no service account, Firebase will be disabled[39m
     [90m 55 |[39m [36mif[39m ([33m![39mserviceAccount) {
    [31m[1m>[22m[39m[90m 56 |[39m   console[33m.[39mwarn([32m'âš ï¸  Firebase service account not found. Firebase features will be disabled.'[39m)[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 57 |[39m   console[33m.[39mwarn([32m'   Place firebase-service-account.json in backend/config/ to enable Firebase.'[39m)[33m;[39m
     [90m 58 |[39m }
     [90m 59 |[39m[0m

      at Object.warn (utils/firebaseAdmin.js:56:11)
      at Object.require (Route/authRoutes.js:7:15)
      at Object.require (app.js:94:35)
      at Object.require (tests/donor.test.js:2:13)

  console.warn
       Place firebase-service-account.json in backend/config/ to enable Firebase.

    [0m [90m 55 |[39m [36mif[39m ([33m![39mserviceAccount) {
     [90m 56 |[39m   console[33m.[39mwarn([32m'âš ï¸  Firebase service account not found. Firebase features will be disabled.'[39m)[33m;[39m
    [31m[1m>[22m[39m[90m 57 |[39m   console[33m.[39mwarn([32m'   Place firebase-service-account.json in backend/config/ to enable Firebase.'[39m)[33m;[39m
     [90m    |[39m           [31m[1m^[22m[39m
     [90m 58 |[39m }
     [90m 59 |[39m
     [90m 60 |[39m [90m// Initialize Firebase Admin SDK only if credentials are available[39m[0m

      at Object.warn (utils/firebaseAdmin.js:57:11)
      at Object.require (Route/authRoutes.js:7:15)
      at Object.require (app.js:94:35)
      at Object.require (tests/donor.test.js:2:13)

  console.log
    directBookSlot: function

      at Object.log (controllers/userController.js:1064:9)

  console.log
    getApprovedBloodBanks: function

      at Object.log (controllers/userController.js:1065:9)

  console.log
    directBookSlot: function

      at Object.log (Route/userRoutes.js:10:9)

  console.log
    getApprovedBloodBanks: function

      at Object.log (Route/userRoutes.js:11:9)

  console.log
    directBookSlot value: [Function (anonymous)]

      at Object.log (Route/userRoutes.js:12:9)

  console.log
    All destructured: {
      me: [Function (anonymous)],
      updateMe: [Function (anonymous)],
      updateDonorAvailability: [Function (anonymous)],
      uploadProfileImage: [Function (anonymous)],
      completeProfile: [Function (anonymous)],
      directBookSlot: [Function (anonymous)],
      getApprovedBloodBanks: [Function (anonymous)]
    }

      at Object.log (Route/userRoutes.js:13:9)

  console.log
    Registration request received. Body: {
      name: 'Test User',
      email: 'testuser@example.com',
      password: 'Password123!',
      confirmPassword: 'Password123!',
      role: 'user',
      provider: 'local'
    }

      at log (Route/authRoutes.js:185:13)

  console.log
    Validation passed. Parsed data: {
      name: 'Test User',
      email: 'testuser@example.com',
      password: 'Password123!',
      confirmPassword: 'Password123!',
      role: 'user',
      provider: 'local'
    }

      at log (Route/authRoutes.js:202:13)

  console.log
    Creating user with data: {
      username: 'testuser@example.com',
      name: 'Test User',
      role: 'user',
      provider: 'local',
      email: 'testuser@example.com',
      password: 'Password123!'
    }

      at log (Route/authRoutes.js:244:13)

  console.log
    User created, saving...

      at log (Route/authRoutes.js:246:13)

  console.log
    User saved successfully

      at log (Route/authRoutes.js:248:13)

[0mPOST /api/auth/register [32m201[0m 632.503 ms - 146[0m
[0mPOST /api/auth/login [32m200[0m 162.608 ms - 616[0m
[0mPOST /api/donors/register [33m400[0m 45.895 ms - 662[0m
[0mGET /api/donors/search?bloodGroup=A%2B&city=Test%20City [32m200[0m 231.208 ms - 117[0m
FAIL tests/donor.test.js
  Donor Registration and Search
    Ã— Register donor profile (52 ms)
    âˆš Search donors (236 ms)

  â— Donor Registration and Search â€º Register donor profile

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 400

    [0m [90m 78 |[39m         contactPreference[33m:[39m [32m'phone'[39m[33m,[39m
     [90m 79 |[39m       })[33m;[39m
    [31m[1m>[22m[39m[90m 80 |[39m     expect(res[33m.[39mstatusCode)[33m.[39mtoBe([35m201[39m)[33m;[39m
     [90m    |[39m                            [31m[1m^[22m[39m
     [90m 81 |[39m     expect(res[33m.[39mbody[33m.[39msuccess)[33m.[39mtoBe([36mtrue[39m)[33m;[39m
     [90m 82 |[39m     expect(res[33m.[39mbody[33m.[39mmessage)[33m.[39mtoMatch([35m/Donor registered/[39m)[33m;[39m
     [90m 83 |[39m   })[33m;[39m[0m

      at Object.toBe (tests/donor.test.js:80:28)

Test Suites: 1 failed, 1 total
Tests:       1 failed, 1 passed, 2 total
Snapshots:   0 total
Time:        4.39 s, estimated 6 s
Ran all test suites.
